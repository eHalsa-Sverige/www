---
layout: default
title: Kalender
description: "Här samlar vi alla event som berör eHälsa i sverige"
sitemap:
  lastmod: 2021-08-10
  priority: 0.8
  changefreq: 'weekly'
---
<section>
    <div class="calendarbody">
        <div id="calendar"></div>
    </div>
    <p style="text-align: center;"><i>Har vi missat något event? <a href="http://localhost:4000/index.html#form-message">Kontakta oss!</a></i></p>
</section>
<link href='/assets/css/fullcalendar.min.css' rel='stylesheet' />
<style>
    #calendar, .fc-daygrid-dot-event .fc-event-title {
        font-size: 0.6rem;
        font-weight: 200;
    }
    .fc .fc-daygrid-day.fc-day-today {
        background-color: #{{ site.color.light }};
    }
    .fc-h-event {
        background-color: #{{ site.color.primary }};
        border: solid 1px #{{ site.color.primary }};
    }
    .fc-daygrid-event-dot {
        border-color: #{{ site.color.primary }};
    }
    .fc .fc-button-primary:disabled, .fc .fc-button-primary {
        border-color: #{{ site.color.medium }};
        background-color: #{{ site.color.medium }};
    }
    .fc .fc-button-primary:hover:not(.fc .fc-button-primary:disabled) {
        border-color: #{{ site.color.primary }};
        background-color: #{{ site.color.primary }};
    }
</style>
<script src='/assets/js/fullcalendar.min.js'></script>
<script>


var sheetID = '1cPIwY55QT-ef1VTr2bKS50gw5NtqFjwJkJXyqBTgmtw';
var getJSON = function(url, callback) {
    var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'json';
        xhr.onload = function() {
            var status = xhr.status;
            if (status == 200) {
                callback(null, xhr.response);
            } else {
                callback(status);
            }
        };
        xhr.send();
};
getJSON('https://spreadsheets.google.com/feeds/cells/' + sheetID + '/1/public/values?alt=json',  function(err, rawdata) {
    if (err != null) {
        console.error(err);
    }else{
        if(!rawdata.feed){ var data = JSON.parse(rawdata); }else{ var data = rawdata; };
        var wrapper = document.getElementById('event-wrapper');
        var array = [];
        for (var i = 0; i < data.feed.entry.length; i++){
            if(data.feed.entry[i].gs$cell['row'] == '1'){}else{
                var arrnum = data.feed.entry[i].gs$cell['row'] - 2;
                if(!array[arrnum]){ array.push({start: '', end: '', title: '', link: '', organizer: '', theme: ''}); };
                var colnum = data.feed.entry[i].gs$cell['col'];
                var content = data.feed.entry[i].content['$t'];
                if(colnum == 1) {
                    array[arrnum].start = content;
                }else if(colnum == 2) {
                    array[arrnum].end = content;
                }else if(colnum == 3) {
                    array[arrnum].title = content;
                }else if(colnum == 4) {
                    array[arrnum].link = content;
                }else if(colnum == 5) {
                    array[arrnum].organizer = content;
                }else if(colnum == 6) {
                    array[arrnum].theme = content;
                }else{
                    console.log('Något är fel med kalender kalkylen.');
                };
            };
        };
        array.sort(function(a , b) { return a.millisec - b.millisec; });
        var events = [];
        for (var a = 0; a < array.length; a++){
            var eventtopush = {title: array[a].title, start: array[a].start, url: array[a].link};
            if(!array[a].end || array[a].end == ''){}else{
                var datea = new Date(array[a].end);
                var dateb = datea.getTime() + (((1000 * 60) * 60) * 24);
                var datec = new Date(dateb);
                eventtopush.end = datec.getFullYear() + '-' + (datec.getMonth() + 1).toString().padStart(2, 0) + '-' + datec.getDate().toString().padStart(2, 0);
                console.log(eventtopush.end);
            };
            console.log(eventtopush)
            events.push(eventtopush);
        };
        addKalender(events);
    };
});
function addKalender(ev){
    var calendarEl = document.getElementById('calendar');
    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        events: ev
    });
    calendar.render();
};
</script>