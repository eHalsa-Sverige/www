<div id="{{ include.id }}" class="news-list"></div>
<script>
    var {{ include.id }}Icons = {
        ehalsomyndigheten: 'https://www.ehalsomyndigheten.se/static/ehm/images/favicon-196x196.png?v=3',
        socialstyrelsen: 'https://www.socialstyrelsen.se/ClientResources/Images/icons/faviconsos.se.png',
        ehealtharena: 'https://www.ehealtharena.se/wp-content/themes/ehealtharena/assets/img/favicons/apple-touch-icon.png'
    };
    function buildList(){
        var allData = [];
        for (let i = 0; i < jsonData.length; i++) {
            if(!jsonData[i]){

            }else{
                for (let a = 0; a < jsonData[i].length; a++) {
                    allData.push({datum: jsonData[i][a].pubDate, titel: jsonData[i][a].title, link: jsonData[i][a].link});
                };
            };
        };
        allData.sort(function(a, b){return b.datum.split(' ')[0].replace(/-/g, '') - a.datum.split(' ')[0].replace(/-/g, '')});
        var wrapper = document.getElementById('{{ include.id }}');
        for (let i = 0; i < allData.length; i++) {
            if(i == parseInt({{ include.antal }})){ break; };
            var id = allData[i].link.replace('www.', '').replace('http://', '').replace('https://', '').split('.')[0];
            var line = document.createElement('a');
                line.setAttribute('href', allData[i].link);
                line.setAttribute('target', '_blank');
                var date = document.createElement('span');
                    var datet = document.createTextNode(minDate(allData[i].datum.split(' ')[0]));
                    date.appendChild(datet);
                line.appendChild(date);
                var icon = document.createElement('span');
                    var iconb = document.createElement('img');
                        iconb.setAttribute('src', {{ include.id }}Icons[id]);
                        iconb.setAttribute('height', '35px');
                        iconb.setAttribute('width', '35px');
                    icon.appendChild(iconb);
                line.appendChild(icon);
                var title = document.createElement('span');
                    var titlet = document.createTextNode(allData[i].titel);
                    title.appendChild(titlet);
                line.appendChild(title);
            wrapper.appendChild(line);
        };
    };
    var loadFile = function (filePath, done) {
        var xhr = new XMLHttpRequest();
            xhr.onload = function () { return done(this.responseText) }
            xhr.open("GET", 'https://api.rss2json.com/v1/api.json?rss_url=' + encodeURI(filePath), true);
            xhr.send();
    };
    var myFiles = {{ include.url }};
    var jsonData = [];
    myFiles.forEach(function (file, i) {
        loadFile(file, function (responseText) {
            jsonData[i] = JSON.parse(responseText).items;
            if(myFiles.length == jsonData.length){
                var gogo = true;
                for (let a = 0; a < jsonData.length; a++) {
                    if(!jsonData[a]){gogo = false;};
                };
                if(gogo){
                    buildList();
                };
            };
        });
    });
</script>